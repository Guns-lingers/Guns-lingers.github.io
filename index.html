<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π –ø–æ–º–æ—â–Ω–∏–∫</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* –°—Ç–∏–ª–∏ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø—Ä–∏–º–µ—Ä–∞ */
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <h1>üíä –í–∞—à–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏–µ–º–∞ –ª–µ–∫–∞—Ä—Å—Ç–≤</h1>
            <div id="schedulesList"></div>
            <button id="createScheduleBtn" class="btn">üìù –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ</button>
        </div>
    </div>

    <script>
        const webApp = Telegram.WebApp;
        const user_id = new URLSearchParams(window.location.search).get('user_id');
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        webApp.expand();
        webApp.setHeaderColor('#2e6e9e');
        webApp.setBackgroundColor('#f8f9fa');
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        async function loadUserData() {
            try {
                const response = await fetch(`/user_data?user_id=${user_id}`);
                const data = await response.json();
                renderSchedules(data.schedules);
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
            }
        }
        
        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π
        function renderSchedules(schedules) {
            const container = document.getElementById('schedulesList');
            // ... –ª–æ–≥–∏–∫–∞ –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ ...
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
        document.getElementById('createScheduleBtn').addEventListener('click', () => {
            webApp.showPopup({
                title: '–°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è',
                message: '–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ:',
                buttons: [{id: 'create', type: 'default', text: '–°–æ–∑–¥–∞—Ç—å'}]
            }, (btnId) => {
                if (btnId === 'create') {
                    const name = prompt('–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è:');
                    if (name) {
                        webApp.sendData(JSON.stringify({
                            action: 'create_schedule',
                            name: name
                        }));
                        webApp.close();
                    }
                }
            });
        });
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
        loadUserData();
    </script>
</body>
</html>